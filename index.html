<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#0ea5e9">
    <meta name="color-scheme" content="dark light">
    
    <!-- Primary Meta Tags -->
    <title>Last War Nexus - VS Points & Arms Race Optimizer</title>
    <meta name="title" content="Last War Nexus - VS Points & Arms Race Optimizer">
    <meta name="description" content="Maximize VS points efficiency by tracking Arms Race phases and Alliance Duel alignment windows for Last War: Survival players.">
    <meta name="keywords" content="Last War Survival, VS Points, Arms Race, Alliance Duel, optimization, strategy, gaming">
    <meta name="author" content="Last War Nexus">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://lastwar-nexus.com/">
    <meta property="og:title" content="Last War Nexus - VS Points Optimizer">
    <meta property="og:description" content="Maximize VS points efficiency by tracking Arms Race phases and Alliance Duel alignment windows for Last War: Survival players.">
    <meta property="og:image" content="https://lastwar-nexus.com/og-image.png">
    <meta property="og:site_name" content="Last War Nexus">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://lastwar-nexus.com/">
    <meta property="twitter:title" content="Last War Nexus - VS Points Optimizer">
    <meta property="twitter:description" content="Maximize VS points efficiency by tracking Arms Race phases and Alliance Duel alignment windows for Last War: Survival players.">
    <meta property="twitter:image" content="https://lastwar-nexus.com/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LW Nexus">
    
    <!-- Microsoft PWA Meta Tags -->
    <meta name="msapplication-TileColor" content="#0ea5e9">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Load CSS files -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/mobile.css">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Last War Nexus",
        "description": "VS Points & Arms Race optimization tool for Last War: Survival players",
        "url": "https://lastwar-nexus.com",
        "applicationCategory": "GameApplication",
        "operatingSystem": "Web Browser",
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareVersion": "1.0.0",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "Last War Nexus"
        }
    }
    </script>
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Main Application Container -->
    <div class="app-container" id="app-container">
        <!-- Header Navigation -->
        <header class="main-nav" role="banner">
            <nav class="nav-container" role="navigation" aria-label="Main navigation">
                <div class="brand">
                    <div class="brand-icon-container">
                        <span class="brand-icon" aria-hidden="true">üéØ</span>
                        <div class="brand-glow" aria-hidden="true"></div>
                    </div>
                    <div class="brand-info">
                        <span class="brand-text">Last War Nexus</span>
                        <span class="brand-subtitle">VS Points Optimizer</span>
                    </div>
                </div>
                
                <div class="nav-actions">
                    <!-- Time Toggle Button -->
                    <button class="time-toggle-btn" type="button" aria-label="Toggle between local and server time">
                        <span class="time-toggle-icon" aria-hidden="true">üïê</span>
                        <span class="time-toggle-label">Local Time</span>
                    </button>
                    
                    <!-- Settings Dropdown -->
                    <div class="settings-dropdown-container">
                        <button class="settings-btn" type="button" aria-label="Open settings" aria-expanded="false">
                            <span aria-hidden="true">‚öôÔ∏è</span>
                            Settings
                        </button>
                        
                        <div class="settings-dropdown" role="menu" aria-label="Settings menu">
                            <div class="dropdown-header">
                                <h3>Settings & Configuration</h3>
                                <p>Adjust timezone and phase settings for accurate calculations</p>
                            </div>
                            <div class="dropdown-content">
                                <div class="setting-item">
                                    <label for="settings-timezone">Server Timezone</label>
                                    <select id="settings-timezone" class="form-select">
                                        <option value="0">UTC +0 hours</option>
                                        <!-- Options populated by JavaScript -->
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <label for="settings-notifications">
                                        <input type="checkbox" id="settings-notifications">
                                        Enable Priority Notifications
                                    </label>
                                </div>
                                <div class="setting-actions">
                                    <button type="button" class="btn btn-secondary" data-action="reset-settings">
                                        Reset to Defaults
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Dashboard Section -->
        <section class="dashboard-section" id="main-content">
            <div class="dashboard-grid-compact">
                <div class="main-cards">
                    <div class="current-status-card">
                        <div class="card-header">
                            <h2>üéØ Current Priority Status</h2>
                            <div class="status-indicator" id="status-indicator">
                                <span class="status-dot"></span>
                                <span class="status-text">Loading...</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="status-grid">
                                <div class="status-item">
                                    <span class="status-label">VS Day:</span>
                                    <span class="status-value" id="current-vs-day">Loading...</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Arms Race:</span>
                                    <span class="status-value" id="arms-phase">Loading...</span>
                                </div>
                                <div class="status-item">
                                    <span class="status-label">Priority:</span>
                                    <span class="status-value" id="priority-level">Loading...</span>
                                </div>
                            </div>
                            
                            <div class="next-priority-section">
                                <h4>Next Priority Window</h4>
                                <div class="next-priority-info" id="next-priority-info">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="side-cards">
                    <!-- Phase Countdown Card -->
                    <div class="countdown-card-compact">
                        <div class="card-header">
                            <h3>‚è∞ Phase Transition</h3>
                            <div class="time-mode-toggle">
                                <span class="toggle-label" id="toggle-label-local">Local</span>
                                <div class="toggle-switch" id="card-time-toggle">
                                    <div class="toggle-slider"></div>
                                </div>
                                <span class="toggle-label" id="toggle-label-server">Server</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div id="countdown-timer" class="countdown-value">Loading...</div>
                            <div id="current-phase" class="current-phase">Loading...</div>
                            
                            <!-- Countdown Progress Bar -->
                            <div class="countdown-progress-section">
                                <div class="progress-bar-container">
                                    <div class="progress-bar" id="countdown-progress">
                                        <div class="progress-fill" id="countdown-progress-fill"></div>
                                        <div class="progress-glow" id="countdown-progress-glow"></div>
                                    </div>
                                </div>
                                <div class="progress-labels">
                                    <span class="progress-label-start">Phase Start</span>
                                    <span class="progress-label-end">Phase End</span>
                                </div>
                            </div>
                            
                            <div class="time-details">
                                <div class="time-row">
                                    <span class="time-label">Current Time:</span>
                                    <span id="current-display-time" class="time-value">Loading...</span>
                                </div>
                                <div class="time-row">
                                    <span class="time-label">Server Time:</span>
                                    <span id="server-display-time" class="time-value">Loading...</span>
                                </div>
                                <div class="time-row">
                                    <span class="time-label">Phase Ends:</span>
                                    <span id="phase-end-time" class="time-value">Loading...</span>
                                </div>
                            </div>
                            
                            <div class="next-phase-preview">
                                <strong>Next:</strong> <span id="next-phase-preview">Loading...</span>
                            </div>
                        </div>
                    </div>

                    <!-- Strategy Tips Card -->
                    <div class="strategy-card-compact">
                        <div class="card-header">
                            <h3>üí° Quick Tips</h3>
                        </div>
                        <div class="card-content">
                            <div class="tip-item">
                                <strong>VIP Store Value:</strong> VIP Store offers better diamond value than regular store
                            </div>
                            <div class="tip-item">
                                <strong>Friday Focus:</strong> Total Mobilization accepts all activity types - save speedups!
                            </div>
                            <div class="tip-item">
                                <strong>Perfect Timing:</strong> Tech Research + Age of Science = maximum efficiency
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab Navigation -->
        <nav class="tab-navigation" role="navigation" aria-label="Main sections">
            <div class="tab-container" role="tablist">
                <button class="tab-btn active" data-tab="priority" type="button" role="tab" aria-selected="true" id="priority-tab-btn">
                    <div class="tab-content-item">
                        <div class="tab-icon-wrapper">
                            <span class="tab-icon" aria-hidden="true">üéØ</span>
                        </div>
                        <div class="tab-info">
                            <span class="tab-label">Priority Windows</span>
                            <span class="tab-description">High-value alignments</span>
                            <span class="tab-count" id="priority-count">Loading</span>
                        </div>
                    </div>
                </button>
                <button class="tab-btn" data-tab="schedule" type="button" role="tab" aria-selected="false" id="schedule-tab-btn">
                    <div class="tab-content-item">
                        <div class="tab-icon-wrapper">
                            <span class="tab-icon" aria-hidden="true">üóìÔ∏è</span>
                        </div>
                        <div class="tab-info">
                            <span class="tab-label">Event Schedule</span>
                            <span class="tab-description">Complete weekly view</span>
                            <span class="tab-count">7 Days</span>
                        </div>
                    </div>
                </button>
                <button class="tab-btn" data-tab="guides" type="button" role="tab" aria-selected="false" id="guides-tab-btn">
                    <div class="tab-content-item">
                        <div class="tab-icon-wrapper">
                            <span class="tab-icon" aria-hidden="true">üìñ</span>
                        </div>
                        <div class="tab-info">
                            <span class="tab-label">Strategy Hub</span>
                            <span class="tab-description">Tips & seasonal guides</span>
                            <span class="tab-count">7 Guides</span>
                        </div>
                    </div>
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="main-content">
            <div class="tab-content">
                <!-- Priority Windows Tab -->
                <div id="priority-tab" class="tab-panel active" role="tabpanel" aria-labelledby="priority-tab-btn">
                    <div class="section-header">
                        <h2>High Priority VS Points Windows</h2>
                        <p class="section-subtitle">Optimal timing when Arms Race phases align with Alliance Duel days for maximum efficiency</p>
                    </div>
                    <div id="priority-grid" class="priority-grid">
                        <div class="loading-message">Loading priority windows...</div>
                    </div>
                </div>

                <!-- Schedule Tab -->
                <div id="schedule-tab" class="tab-panel" role="tabpanel" aria-labelledby="schedule-tab-btn">
                    <div class="section-header">
                        <h2>Complete Event Schedule</h2>
                        <p class="section-subtitle">Full weekly schedule showing Arms Race phases and Alliance Duel days</p>
                    </div>
                    <div id="schedule-content" class="priority-grid">
                        <div class="loading-message">Loading schedule...</div>
                    </div>
                </div>

                <!-- Guides Tab -->
                <div id="guides-tab" class="tab-panel" role="tabpanel" aria-labelledby="guides-tab-btn">
                    <div class="section-header">
                        <h2>Strategy Guides</h2>
                        <p class="section-subtitle">Expert tips for maximizing VS points and Arms Race efficiency</p>
                    </div>
                    
                    <!-- Guide Type Navigation -->
                    <div class="guide-nav-container">
                        <div class="guide-nav" role="tablist" aria-label="Guide categories">
                            <button class="guide-nav-btn active" data-guide-type="tips" type="button" role="tab" aria-selected="true">
                                <span class="guide-nav-icon" aria-hidden="true">üí°</span>
                                <span class="guide-nav-label">General Tips</span>
                            </button>
                            <button class="guide-nav-btn" data-guide-type="seasonal" type="button" role="tab" aria-selected="false">
                                <span class="guide-nav-icon" aria-hidden="true">üìÖ</span>
                                <span class="guide-nav-label">Seasonal Guides</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Guide Content -->
                    <div id="guides-content" class="priority-grid">
                        <div class="loading-message">Loading guides...</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Priority Events Banner -->
    <aside class="priority-events-banner collapsed" id="priority-events-banner" role="complementary" aria-label="Upcoming priority events">
        <div class="banner-header" role="button" tabindex="0" aria-expanded="false" aria-controls="banner-content">
            <div class="banner-title">
                <span class="banner-icon" aria-hidden="true">‚ö°</span>
                <span class="banner-text">High Priority Events</span>
                <span class="banner-count" id="banner-count">0</span>
            </div>
            <div class="banner-toggle" id="banner-toggle" aria-hidden="true">‚ñº</div>
        </div>
        <div class="banner-content" id="banner-content">
            <div class="banner-grid" id="banner-grid">
                <div class="banner-loading">Loading upcoming events...</div>
            </div>
        </div>
    </aside>

    <!-- Setup Modal -->
    <div class="setup-modal" id="setup-modal" role="dialog" aria-labelledby="setup-modal-title" aria-hidden="true">
        <div class="setup-modal-backdrop"></div>
        <div class="setup-modal-content">
            <div class="setup-header">
                <div class="brand">
                    <div class="brand-icon-container">
                        <span class="brand-icon" aria-hidden="true">üéØ</span>
                    </div>
                    <div class="brand-info">
                        <span class="brand-text">Last War Nexus</span>
                        <span class="brand-subtitle">VS Points Optimizer</span>
                    </div>
                </div>
                <h2 id="setup-modal-title">Welcome to Last War Nexus</h2>
                <p>Configure your server time to maximize VS points efficiency</p>
            </div>
            
            <div class="setup-body">
                <div class="setup-section">
                    <h3>Current Server Time</h3>
                    <div class="server-time-display">
                        <div id="setup-server-time" class="setup-time">Loading...</div>
                        <div class="setup-timezone">UTC <span id="setup-timezone-offset">+0</span></div>
                    </div>
                </div>

                <form class="setup-form" id="setup-form">
                    <div class="setup-section">
                        <label for="setup-time-offset">Time Zone Adjustment</label>
                        <p class="setup-help">Adjust to match your server's time zone</p>
                        <select id="setup-time-offset" class="form-select" required>
                            <option value="0">UTC +0 hours</option>
                            <!-- Options populated by JavaScript -->
                        </select>
                    </div>

                    <div class="setup-section">
                        <label for="setup-current-phase">Current Arms Race Phase (Optional)</label>
                        <p class="setup-help">Override if auto-detection is incorrect</p>
                        <select id="setup-current-phase" class="form-select">
                            <option value="">Auto-detect (recommended)</option>
                            <!-- Options populated by JavaScript -->
                        </select>
                    </div>

                    <div class="setup-section">
                        <label for="setup-next-phase">Next Phase Override (Optional)</label>
                        <p class="setup-help">For testing or manual verification</p>
                        <select id="setup-next-phase" class="form-select">
                            <option value="">Auto-detect (recommended)</option>
                            <!-- Options populated by JavaScript -->
                        </select>
                    </div>

                    <div class="setup-actions">
                        <button type="button" class="btn btn-primary" data-action="complete-setup">
                            Complete Setup
                        </button>
                        <button type="button" class="btn btn-secondary" data-action="close-modal">
                            Skip for Now
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Load the original working JavaScript -->
    <script src="app.js"></script>

    <!-- Register Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>