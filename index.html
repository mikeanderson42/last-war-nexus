<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>VS Points Optimizer - Last War Nexus</title>
    <meta name="description" content="Professional Last War Survival tracker for maximizing VS points during Alliance Duels">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚öîÔ∏è</text></svg>">
</head>
<body>
    <!-- Initial Setup Modal -->
    <div id="initial-setup-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container setup-modal">
            <div class="modal-header">
                <h2>‚öîÔ∏è Quick Setup</h2>
                <p class="setup-subtitle">Configure your VS Points Optimizer (30 seconds)</p>
            </div>
            <div class="modal-content setup-content">
                <div class="setup-section">
                    <h3>üîî Notifications</h3>
                    <p>Get alerts for priority windows and phase changes</p>
                    <button id="enable-notifications" class="setup-btn primary">Enable Notifications</button>
                    <button id="skip-notifications" class="setup-btn secondary">Skip</button>
                </div>
                
                <div class="setup-section">
                    <h3>üåç Server Time</h3>
                    <p>Align with your server for accurate timing</p>
                    <div class="time-preview">
                        <span>Current Server Time: </span>
                        <span id="setup-server-time" class="time-display">Loading...</span>
                    </div>
                    <select id="setup-time-offset" class="setup-select">
                        <option value="-12">UTC -12 hours</option>
                        <option value="-11">UTC -11 hours</option>
                        <option value="-10">UTC -10 hours</option>
                        <option value="-9">UTC -9 hours</option>
                        <option value="-8">UTC -8 hours</option>
                        <option value="-7">UTC -7 hours</option>
                        <option value="-6">UTC -6 hours</option>
                        <option value="-5">UTC -5 hours</option>
                        <option value="-4">UTC -4 hours</option>
                        <option value="-3">UTC -3 hours</option>
                        <option value="-2">UTC -2 hours</option>
                        <option value="-1">UTC -1 hour</option>
                        <option value="0" selected>UTC +0 hours</option>
                        <option value="1">UTC +1 hour</option>
                        <option value="2">UTC +2 hours</option>
                        <option value="3">UTC +3 hours</option>
                        <option value="4">UTC +4 hours</option>
                        <option value="5">UTC +5 hours</option>
                        <option value="6">UTC +6 hours</option>
                        <option value="7">UTC +7 hours</option>
                        <option value="8">UTC +8 hours</option>
                        <option value="9">UTC +9 hours</option>
                        <option value="10">UTC +10 hours</option>
                        <option value="11">UTC +11 hours</option>
                        <option value="12">UTC +12 hours</option>
                    </select>
                </div>
                
                <div class="setup-section">
                    <h3>‚öîÔ∏è Arms Race Phases</h3>
                    <p>Set current and next phases for accurate predictions</p>
                    <div class="phase-inputs">
                        <div class="phase-input-group">
                            <label>Current Phase</label>
                            <select id="setup-current-phase" class="setup-select">
                                <option value="Tech Research" selected>Tech Research</option>
                                <option value="Drone Boost">Drone Boost</option>
                                <option value="Hero Advancement">Hero Advancement</option>
                                <option value="City Building">City Building</option>
                                <option value="Unit Progression">Unit Progression</option>
                            </select>
                        </div>
                        <div class="phase-input-group">
                            <label>Next Phase</label>
                            <select id="setup-next-phase" class="setup-select">
                                <option value="Tech Research">Tech Research</option>
                                <option value="Drone Boost" selected>Drone Boost</option>
                                <option value="Hero Advancement">Hero Advancement</option>
                                <option value="City Building">City Building</option>
                                <option value="Unit Progression">Unit Progression</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="complete-setup" class="setup-btn primary large">Complete Setup</button>
                <button id="skip-setup" class="setup-btn secondary">Skip - Use Defaults</button>
            </div>
        </div>
    </div>

    <!-- Arms Race Update Modal -->
    <div id="arms-race-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3>üéØ Quick Arms Race Update</h3>
                <p>Your Arms Race phase info needs updating for accurate predictions</p>
            </div>
            <div class="modal-content">
                <div class="phase-inputs">
                    <div class="phase-input-group">
                        <label>Current Phase</label>
                        <select id="update-current-phase" class="setup-select">
                            <option value="Tech Research">Tech Research</option>
                            <option value="Drone Boost">Drone Boost</option>
                            <option value="Hero Advancement">Hero Advancement</option>
                            <option value="City Building">City Building</option>
                            <option value="Unit Progression">Unit Progression</option>
                        </select>
                    </div>
                    <div class="phase-input-group">
                        <label>Next Phase</label>
                        <select id="update-next-phase" class="setup-select">
                            <option value="Tech Research">Tech Research</option>
                            <option value="Drone Boost">Drone Boost</option>
                            <option value="Hero Advancement">Hero Advancement</option>
                            <option value="City Building">City Building</option>
                            <option value="Unit Progression">Unit Progression</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="update-arms-race" class="setup-btn primary">Update Phases</button>
                <button id="cancel-arms-update" class="setup-btn secondary">Cancel</button>
            </div>
        </div>
    </div>

    <nav class="main-nav">
        <div class="nav-container">
            <div class="brand-section">
                <div class="brand">
                    <div class="brand-icon-container">
                        <span class="brand-icon">‚öîÔ∏è</span>
                        <div class="brand-glow"></div>
                    </div>
                    <div class="brand-info">
                        <span class="brand-text">Last War Nexus</span>
                        <span class="brand-subtitle">VS Points & Arms Race Optimization</span>
                    </div>
                </div>
            </div>
            
            <div class="nav-actions">
                <div class="server-dropdown-container">
                    <button class="server-btn" id="server-toggle" type="button" aria-label="Server Settings">
                        <span class="server-icon" aria-hidden="true">‚öôÔ∏è</span>
                        <span class="server-label">Server</span>
                    </button>
                    <div class="server-dropdown" id="server-dropdown" role="menu" aria-labelledby="server-toggle">
                        <div class="dropdown-header">
                            <h3>Server Settings</h3>
                        </div>
                        <div class="dropdown-content">
                            <!-- UPDATED: Current + Next Phase Selection -->
                            <div class="setting-row">
                                <label for="current-arms-phase">Current Arms Race Phase</label>
                                <select id="current-arms-phase" class="dropdown-select" aria-describedby="phase-help">
                                    <option value="Tech Research" selected>Tech Research</option>
                                    <option value="Drone Boost">Drone Boost</option>
                                    <option value="Hero Advancement">Hero Advancement</option>
                                    <option value="City Building">City Building</option>
                                    <option value="Unit Progression">Unit Progression</option>
                                </select>
                            </div>
                            
                            <div class="setting-row">
                                <label for="next-arms-phase">Next Arms Race Phase</label>
                                <select id="next-arms-phase" class="dropdown-select">
                                    <option value="Tech Research">Tech Research</option>
                                    <option value="Drone Boost" selected>Drone Boost</option>
                                    <option value="Hero Advancement">Hero Advancement</option>
                                    <option value="City Building">City Building</option>
                                    <option value="Unit Progression">Unit Progression</option>
                                </select>
                                <div id="phase-help" class="sr-only">Select your server's current Arms Race phase</div>
                            </div>
                            
                            <div class="setting-row" style="margin-top: 12px;">
                                <label for="time-offset">Server Time Offset</label>
                                <select id="time-offset" class="dropdown-select" aria-describedby="offset-help">
                                    <option value="-12">UTC -12 hours</option>
                                    <option value="-11">UTC -11 hours</option>
                                    <option value="-10">UTC -10 hours</option>
                                    <option value="-9">UTC -9 hours</option>
                                    <option value="-8">UTC -8 hours</option>
                                    <option value="-7">UTC -7 hours</option>
                                    <option value="-6">UTC -6 hours</option>
                                    <option value="-5">UTC -5 hours</option>
                                    <option value="-4">UTC -4 hours</option>
                                    <option value="-3">UTC -3 hours</option>
                                    <option value="-2">UTC -2 hours</option>
                                    <option value="-1">UTC -1 hour</option>
                                    <option value="0" selected>UTC 0 hours</option>
                                    <option value="1">UTC +1 hour</option>
                                    <option value="2">UTC +2 hours</option>
                                    <option value="3">UTC +3 hours</option>
                                    <option value="4">UTC +4 hours</option>
                                    <option value="5">UTC +5 hours</option>
                                    <option value="6">UTC +6 hours</option>
                                    <option value="7">UTC +7 hours</option>
                                    <option value="8">UTC +8 hours</option>
                                    <option value="9">UTC +9 hours</option>
                                    <option value="10">UTC +10 hours</option>
                                    <option value="11">UTC +11 hours</option>
                                    <option value="12">UTC +12 hours</option>
                                </select>
                                <div id="offset-help" class="sr-only">Set your server's time offset from UTC</div>
                            </div>
                            
                            <div class="server-info" id="server-info">
                                <div class="info-row">
                                    <span class="info-label">Current Phase</span>
                                    <span id="current-phase-display" class="info-value">Tech Research</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Next Phase</span>
                                    <span id="next-phase-display" class="info-value">Drone Boost</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Server Time</span>
                                    <span id="server-time-display" class="info-value">Loading...</span>
                                </div>
                                <div class="info-row">
                                    <span class="info-label">Time Offset</span>
                                    <span id="offset-display" class="info-value">UTC +0</span>
                                </div>
                            </div>
                            
                            <button class="apply-server-btn" id="apply-server" type="button" aria-label="Apply server settings">Apply Changes</button>
                        </div>
                    </div>
                </div>
                
                <div class="settings-dropdown-container">
                    <button class="settings-btn" id="settings-toggle" type="button" aria-label="Display Settings">
                        <span class="settings-icon" aria-hidden="true">üéÆ</span>
                        <span class="settings-label">Display</span>
                    </button>
                    <div class="settings-dropdown" id="settings-dropdown" role="menu" aria-labelledby="settings-toggle">
                        <div class="dropdown-header">
                            <h3>Display Settings</h3>
                        </div>
                        <div class="dropdown-content">
                            <div class="setting-row">
                                <label for="time-format-dropdown">Time Format</label>
                                <select id="time-format-dropdown" class="dropdown-select">
                                    <option value="utc" selected>UTC Server Time</option>
                                    <option value="local">Local Time</option>
                                </select>
                            </div>
                            <!-- REMOVED: Detail Level Dropdown -->
                            <div class="setting-row">
                                <label for="notification-alerts">Priority Alerts</label>
                                <select id="notification-alerts" class="dropdown-select">
                                    <option value="off">Disabled</option>
                                    <option value="15min" selected>15 min before</option>
                                    <option value="5min">5 min before</option>
                                    <option value="both">Both 15min & 5min</option>
                                </select>
                            </div>
                            <div class="setting-row">
                                <label for="phase-alerts">Phase Change Alerts</label>
                                <select id="phase-alerts" class="dropdown-select">
                                    <option value="off">Disabled</option>
                                    <option value="10min" selected>10 min before</option>
                                    <option value="immediate">At transition</option>
                                    <option value="both">Both</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="app-container">
        <section class="hero-dashboard-compact">
            <div class="dashboard-grid-compact">
                <div class="priority-main-card">
                    <div class="card-header gaming-header">
                        <div class="header-left">
                            <h2>VS Points Optimizer</h2>
                            <div class="live-indicator-small">
                                <div class="pulse-dot-mini"></div>
                                <span>LIVE</span>
                            </div>
                        </div>
                        <div class="time-display-enhanced">
                            <div id="server-time" class="server-time-gaming" title="Current server time">04:21:41</div>
                            <div id="local-time" class="local-time-small" title="Your local time">12:21:41</div>
                            <button id="sync-time" class="sync-btn" title="Sync with server">üîÑ</button>
                        </div>
                    </div>
                    <div class="card-content gaming-content">
                        <div class="priority-gaming-hero" id="priority-hero">
                            <div class="active-now-strip" id="active-now" style="display: none;">
                                <span class="active-badge">ACTIVE</span>
                                <span id="active-action">Use research speedups now!</span>
                            </div>
                            
                            <div class="hero-badge">
                                <div class="badge-icon">‚ö°</div>
                                <div id="badge-label" class="badge-label">NEXT HIGH PRIORITY</div>
                            </div>
                            
                            <div class="countdown-gaming-display">
                                <div id="next-priority-time" class="countdown-main-gaming">2h 37m</div>
                                <div id="countdown-label" class="countdown-label">TIME REMAINING</div>
                            </div>
                            
                            <div class="event-gaming-card">
                                <div class="event-icon-large">üî¨</div>
                                <div class="event-details-gaming">
                                    <div class="event-row">
                                        <div id="next-priority-event" class="event-name-gaming">Tech Research Wednesday</div>
                                        <div id="efficiency-level" class="efficiency-badge">High</div>
                                        <div class="info-tooltip" data-tooltip="Research activities are in peak efficiency">‚ÑπÔ∏è</div>
                                    </div>
                                    <div id="event-day-gaming" class="event-timing-gaming">Wednesday 12:00 UTC</div>
                                    <div id="current-action" class="event-action-gaming">Complete research projects for maximum points</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="status-footer-gaming">
                            <div class="status-items-gaming">
                                <div class="status-item-gaming">
                                    <div class="item-label">VS Day</div>
                                    <div id="current-vs-day" class="item-value">Wednesday</div>
                                </div>
                                <div class="status-divider-gaming">‚Ä¢</div>
                                <div class="status-item-gaming">
                                    <div class="item-label">Arms Race</div>
                                    <div id="arms-phase" class="item-value" data-tooltip="Current Arms Race phase">Tech Research</div>
                                </div>
                                <div class="status-divider-gaming">‚Ä¢</div>
                                <div class="status-item-gaming">
                                    <div class="item-label">Next Reset</div>
                                    <div id="next-reset-countdown" class="item-value highlight">12h 37m</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="side-cards">
                    <div class="countdown-card-compact">
                        <div class="card-header">
                            <h3>Phase Transition</h3>
                            <div class="priority-indicator"></div>
                        </div>
                        <div class="card-content">
                            <div id="countdown-timer" class="countdown-value">43m 22s</div>
                            <div class="phase-info">
                                <div id="current-phase-name" class="current-phase">Tech Research</div>
                                <div class="phase-arrow">‚Üí</div>
                                <div id="next-phase-name" class="next-phase">Drone Boost Next</div>
                            </div>
                            <div class="phase-progress-container">
                                <div class="phase-progress-bar">
                                    <div id="phase-progress-fill" class="phase-progress-fill" style="width: 65%;"></div>
                                </div>
                                <div class="phase-labels">
                                    <span>Started</span>
                                    <span>Ending</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="strategy-card-compact">
                        <div class="card-header">
                            <h3>Strategy</h3>
                            <div class="strategy-rating">
                                <span id="strategy-rating" class="rating-value">A</span>
                            </div>
                        </div>
                        <div class="card-content">
                            <div id="action-text" class="action-text">Save speedups for high priority windows that align with VS day activities</div>
                            <div class="strategy-meta">
                                <span class="meta-label">Priority:</span>
                                <span id="priority-level" class="priority-tag">Medium</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="tab-navigation-enhanced">
            <div class="tab-container" role="tablist" aria-label="Main navigation tabs">
                <button class="tab-btn active" data-tab="priority" type="button" role="tab" aria-selected="true" aria-controls="priority-tab">
                    <div class="tab-content">
                        <span class="tab-icon" aria-hidden="true">‚ö°</span>
                        <div class="tab-info">
                            <span class="tab-label">VS Points Optimizer</span>
                            <span class="tab-count" id="priority-count">Loading</span>
                        </div>
                    </div>
                </button>
                <button class="tab-btn" data-tab="schedule" type="button" role="tab" aria-selected="false" aria-controls="schedule-tab">
                    <div class="tab-content">
                        <span class="tab-icon" aria-hidden="true">üìÖ</span>
                        <div class="tab-info">
                            <span class="tab-label">Arms Race Schedule</span>
                            <span class="tab-count" id="schedule-count">42 Events</span>
                        </div>
                    </div>
                </button>
                <button class="tab-btn" data-tab="guides" type="button" role="tab" aria-selected="false" aria-controls="guides-tab">
                    <div class="tab-content">
                        <span class="tab-icon" aria-hidden="true">üìö</span>
                        <div class="tab-info">
                            <span class="tab-label">Strategy Guides</span>
                            <span class="tab-count" id="guides-count">8 Guides</span>
                        </div>
                    </div>
                </button>
            </div>
        </div>

        <main class="main-content">
            <div class="tab-content">
                <div id="priority-tab" class="tab-panel active" role="tabpanel" aria-labelledby="priority-btn">
                    <div class="section-header">
                        <h2>Maximum VS Points Windows</h2>
                        <p class="section-subtitle">Optimal timing windows when activities contribute to both Alliance Duel VS points AND Arms Race points simultaneously</p>
                        <div class="priority-explanation">
                            <div class="explanation-card">
                                <span class="explanation-icon">üéØ</span>
                                <span class="explanation-text">High Priority: Activities that earn points for BOTH events simultaneously</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="section-filters" role="group" aria-label="Filter priority windows">
                        <button class="filter-btn active" data-filter="all" type="button" aria-pressed="true">All Windows</button>
                        <button class="filter-btn" data-filter="active" type="button" aria-pressed="false">Active Now</button>
                        <button class="filter-btn" data-filter="upcoming" type="button" aria-pressed="false">Upcoming</button>
                    </div>
                    
                    <div id="priority-grid" class="priority-grid" aria-live="polite">
                        <div class="skeleton-grid">
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                            <div class="skeleton-card"></div>
                        </div>
                    </div>
                </div>
                
                <div id="schedule-tab" class="tab-panel" role="tabpanel" aria-labelledby="schedule-btn">
                    <div class="section-header">
                        <h2>Complete Arms Race Schedule</h2>
                        <p class="section-subtitle">Plan your week with the full Arms Race and VS event calendar</p>
                        <div class="schedule-legend">
                            <div class="legend-item">
                                <div class="legend-color priority"></div>
                                <span>Peak Efficiency</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color current"></div>
                                <span>Active Now</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color normal"></div>
                                <span>Standard</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="schedule-container">
                        <div id="schedule-grid" class="schedule-grid" aria-live="polite"></div>
                    </div>
                </div>
                
                <div id="guides-tab" class="tab-panel" role="tabpanel" aria-labelledby="guides-btn">
                    <div class="section-header">
                        <h2>Last War: Survival Strategy Guides</h2>
                        <p class="section-subtitle">Expert strategies and optimization tips for maximizing your gameplay</p>
                        <div class="guides-stats">
                            <div class="guides-stat">
                                <span class="stat-number">Dual</span>
                                <span class="stat-label">Event Focus</span>
                            </div>
                            <div class="guides-stat">
                                <span class="stat-number">4hr</span>
                                <span class="stat-label">Phase Cycles</span>
                            </div>
                            <div class="guides-stat">
                                <span class="stat-number">6</span>
                                <span class="stat-label">VS Days</span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="guides-content" class="guides-hub" aria-live="polite"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="priority-banner" id="priority-banner" role="alert" aria-live="assertive">
        <div class="banner-container">
            <div class="banner-content" id="banner-content">
                <div class="banner-icon">‚ö°</div>
                <div class="banner-text">
                    <div class="banner-title" id="banner-title">High Priority Active</div>
                    <div class="banner-subtitle" id="banner-subtitle">Tech Research + Wednesday Research</div>
                </div>
                <div class="banner-time" id="banner-time">2h 37m remaining</div>
                <button class="banner-close" id="banner-close" type="button" aria-label="Close banner">‚úï</button>
            </div>
        </div>
    </div>

    <div id="notification-modal" class="notification-modal" style="display: none;">
        <div class="modal-content">
            <h3>Enable Notifications?</h3>
            <p>Get notified when high-priority VS point windows become active.</p>
            <div class="modal-actions">
                <button id="enable-notifications-popup" class="btn-primary">Enable</button>
                <button id="decline-notifications" class="btn-secondary">Maybe Later</button>
            </div>
        </div>
    </div>

    <div class="sr-only" aria-live="polite" id="status-announcements"></div>
    <script src="app.js"></script>
</body>
</html>
